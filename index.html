<!DOCTYPE html>
<html>
<head>
	<title>Catalyst! Energy Island</title>

<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<link rel="stylesheet" href="css/bootstrap.min.css">
   <style>
   html, body, #map {
      height:100%;
      width:100%;
      padding:0px;
      margin:0px;
   } 
   #overlay {
   padding: 10px;
	bottom: 50px;
    height: 75px;
    position: absolute;
    right: 50px;
    width: 550px;
	opacity:0.9;
filter:alpha(opacity=90); /* For IE8 and earlier */
background-color: white;
		}
   </style>


	<meta charset="utf-8" />

	

	<link rel="stylesheet" href="leaflet-0.7.2/leaflet.css" />
</head>
<body>
	<div id="map" ></div>

	<div id="overlay">
	
		<h2>Find Tilley and Enter your Energy Observation!</h2>
		Click the map where you think Tilley is located.
		<br />Once you have found Tilley, enter your observation and click "Submit"
	
	</div>
	
	<script src="leaflet-0.7.2/leaflet.js"></script>
	<script>
var popupformcontent = '<iframe src="form.html" width=400px height=400px  frameBorder="0" ></iframe>';
		var map = L.map('map').setView([56.5007, -6.8805], 12);  

		L.tileLayer('http://{s}.tile.cloudmade.com/1D162E9F2DCA42C187DB33208932BFB6/997/256/{z}/{x}/{y}.png', {
			maxZoom: 18,
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>, Energy Island by <a href="http://www.catalystproject.org.uk">Catalyst!</a>'
		}).addTo(map);




		/*L.circle([51.508, -0.11], 500, {
			color: 'red',
			fillColor: '#f03',
			fillOpacity: 0.5
		}).addTo(map).bindPopup("I am a circle.");

		L.polygon([
			[51.509, -0.08],
			[51.503, -0.06],
			[51.51, -0.047]
		]).addTo(map).bindPopup("I am a polygon.");
*/

		var popup = L.popup();

		function onMapClick(e) {

			target_lat=56.535727438167584;
        	target_lon=-6.756131332397456;

			if ((e.latlng.lat >= (target_lat-0.003) && e.latlng.lat <= (target_lat+0.003)) && (e.latlng.lng >= (target_lon-0.002) && e.latlng.lng <= (target_lon+0.003))) {

						//popup.setLatLng(e.latlng).setContent("in").openOn(map);
            			//$('#entry_1672423225').val("in");

            			L.marker([56.535727438167584, -6.756131332397456]).addTo(map).bindPopup(popupformcontent,{'maxWidth':900}).openPopup();
			        }
			        else { popup.setLatLng(e.latlng).setContent("<b>Tilley is not here!</b><br/> Try again!").openOn(map);
			        //$('#entry_1672423225').val("out"); 
			    	}
			        //console.log();
/*
			popup
				.setLatLng(e.latlng)
				.setContent("You clicked the map at " + e.latlng.toString())
				.openOn(map);*/
		}

		map.on('click', onMapClick);

	</script>
</body>
</html>
